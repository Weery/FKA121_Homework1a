\input{template_files/packages}

\input{settings}

\title{H1a: Classical scattering by a central potential}
\author{Victor Nilsson and Simon Nilsson}
\date{\today}

\begin{document}

\input{template_files/titlepage}

\section*{Introduction}

Molecular dynamics is a simulation of the movement of atoms and molecules. What is of interest in such a simulations is e.g. the trajectories of the atoms given specific surrounding parameters such as temperature, pressure, crystal formation etc. For this homeproblem we study the dynamics of aluminium atoms in a FCC crystal lattice.

\section*{Problem 1}

\begin{figure}[H]
    \centering
    \captionsetup[subfigure]{justification=centering}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \resizebox{\columnwidth}{!}{\input{graphics/task1/energy01.tikz}}
        \caption{$\Delta t =\unit[0.1]{ASU}$}
        \label{fig:timestep_a}
    \end{subfigure}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \resizebox{\columnwidth}{!}{\input{graphics/task1/energy001.tikz}}
        \caption{$\Delta t =\unit[0.01]{ASU}$}
        \label{fig:timestep_b}
    \end{subfigure}
    \caption{For the different energy simulations, the same number of timesteps was used but the lengths of the different timesteps makes them evolve over different times. As can be seen in \ref{fig:timestep_a}, the energy explodes due to insufficient resolution of the time, something which is not present in \ref{fig:timestep_b}.}
    \label{fig:timestep}
\end{figure}

As we can see in figure \ref{fig:timestep} the required timestep is between $\Delta t = 0.1 \sim \unit[0.01]{ASU}$, so for the rest of the assignment a timestep of $\Delta t = \unit[0.01]{ASU}$ will be used.

\section*{Problem 3}

\begin{figure}[H]
    \centering
    \captionsetup[subfigure]{justification=centering}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphics/task3/pressure.png}
    \end{subfigure}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphics/task3/pressure_avg.png}
    \end{subfigure}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphics/task3/temperature.png}
    \end{subfigure}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphics/task3/temperature_avg.png}
    \end{subfigure}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphics/task3/traj.png}
    \end{subfigure}
    \caption{After the equilibrium, both the pressure and the temperature needs some time to stabilize after rescaling the velocities, but remains stable for longer time. The equalisation temperature was set to $\unit[500]{C^\circ}$.}
    \label{fig:equilibrium500}
\end{figure}

In order to set the system to a certain temperature, a technique involving scaling all the velocities during a equilibrating state. Since the temperature depends on the kinetic energies which in turn depends on the velocities, the  temperature can thusly be changed by changing velocities. In figure \ref{fig:equilibrium500} we can see the temperature after setting the temperature to $\unit[500]{C^\circ}$. There are some fluctuations in the beginning due to the rescaling of the velocities.
 

\section*{Problem 4}

\begin{figure}[H]
    \centering
    \captionsetup[subfigure]{justification=centering}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphics/task4/pressure.png}
    \end{subfigure}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphics/task4/pressure_avg.png}
    \end{subfigure}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphics/task4/temperature.png}
    \end{subfigure}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphics/task4/temperature_avg.png}
    \end{subfigure}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphics/task4/traj.png}
    \end{subfigure}
    \caption{After the equilibrium, both the pressure and the temperature needs some time to stabilize after rescaling the velocities, but remains stable for longer time. The equalisation temperature was first set to $\unit[1000]{C^\circ}$ for the smelting and then the temperature was reduced to $\unit[700]{C^\circ}$.}
    \label{fig:equilibrium500}
\end{figure}


\section*{Problem 5}

$\unit[1]{\frac{j}{mol K}}=\unit[1.0366e-05]{\frac{eV}{K}}$ \\
$C_v\left[AL\right]:\unit[24.20]{\frac{j}{mol K}}=\unit[1.0366e-05]{\frac{eV}{K}}$

\noindent From our MD simulations we obtained the following values for $C_V$ when using the potential and kinetic energy fluctuations respectively.
\begin{table}[h!]
	\centering
	\caption{Heat capacity obtained by measuring energy fluctuations.}
	\begin{tabular}{l|cc}
		\hline \textbf{Temperature} & \textbf{500$^\circ$ C} & \textbf{700$^\circ$ C} \\ \hline
		$C_V / (\unit{eV/kg\,K})$ (kinetic) & $5.819521 \cdot 10^{-2}$ & $5.056438 \cdot 10^{-2}$ \\
		$C_V / (\unit{eV/kg\,K})$ (potential) & $5.836188 \cdot 10^{-2}$ & $5.056541 \cdot 10^{-2}$ \\ \hline
	\end{tabular}
	\label{tab:prob5}
\end{table}

\section*{Problem 6}

When instead using the relation
\begin{equation}
	C_V = \left( \frac{\partial E}{\partial T} \right)_{N,V}
\end{equation}
to compute the heat capacity, and approximate it with a difference quota, we obtain the results found in the table below.

\begin{table}[h!]
	\centering	
	\caption{Heat capacity obtained by approximating the partial energy derivative with respect to the temperature.}
	\begin{tabular}{l|cc}
		\hline \textbf{Temperature} & \textbf{500$^\circ$ C} & \textbf{700$^\circ$ C} \\ \hline
		$C_V / (\unit{eV/kg\,K})$ & $6.436 \cdot 10^{-2}$ & $8.131 \cdot 10^{-2}$ \\ \hline
	\end{tabular}
	\label{tab:prob6}
\end{table}

If we compare these results to those from the previous problem we see that they are slightly larger and the result for 700 degrees deviates by a larger margin. It's possible that a longer equilibration time would yield a more stable temperature than was obtained now and therefore a more accurate heat capacity. A longer measuring time would also increase the accuracy of the result, as well as doing more simulation and averaging the different results. A $\Delta T$ of 5$^\circ$ C was used here, but further experiementing with this parameter could yield a better result as well.

\section*{Problem 7}

\begin{figure}[H]
\centering
\captionsetup[subfigure]{justification=centering}
\begin{subfigure}[b]{0.40\textwidth}
	\centering
	\includegraphics[width=\textwidth]{graphics/task7/radial.png}
\end{subfigure}
\caption{The radial function is computed by taking the histogram over all the internal distances between the atoms then divided by the random distribution of the same density.}
\label{fig:radial}
\end{figure}

\section*{Problem 8}


\begin{figure}[H]
    \centering
    \captionsetup[subfigure]{justification=centering}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphics/task8/integral.png}
    \end{subfigure}
    \begin{subfigure}[b]{0.40\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphics/task8/simulated.png}
    \end{subfigure}
    \caption{The static structure function computed both from the radial distribution function in figure \ref{fig:radial} in the left and using bins in Fourier space to the right.}
    \label{fig:StaticStructure}
\end{figure}

  
  \begin{comment}
\section*{Problem 2}

In the following we give an example of how to produce a table.
Use the code for Table~\ref{tab1} as a template.

\begin{table}[!ht]
  \begin{center}
    \caption{A dummy table}
    \begin{tabular}{l|c|c}\hline\hline
      \textbf{Col.~1} & \textbf{Col.~2} & \textbf{Col.~3} \\ \hline
      the & quick & brown \\ 
      fox & jumps & over \\ 
      the & lazy  & dog \\ 
      \hline\hline
    \end{tabular}
    \label{tab1}
  \end{center}
\end{table}

\section*{Problem 3}

If you find some part of the code particularly interesting you may 
include it in the text, otherwise it should be included in the appedix.
If you do want to include code the following commands will print
the text directly, with no \LaTeX~commands executed:

\begin{lstlisting}[language=matlab]
% Hello world ten times in MATLAB
for i = 1 : 10
  fprintf('Hello world %d!\n',i);
end
\end{lstlisting}

\begin{lstlisting}[language=python]
# Hello world ten times in Python
for i in range(10):
  print 'Hello world %d!' % i
\end{lstlisting}

\section*{Problem 4}
At some point it may be appropriate to include equations. It is done in the
following way:

\begin{equation}
  V(r) = 4\epsilon \left[ \left( \frac{\sigma}{r} \right)^{12} - 
    \left(\frac{\sigma}{r} \right)^{6} \right]
\end{equation}

Do number and reference all your equations.

\section*{Concluding discussion}

Use your favourite flavor of \LaTeX{} to compile the file:
\begin{verbatim}
xelatex template.tex
pdflatex template.tex
latex template.tex
\end{verbatim}
should all work.
If you use \verb+pdflatex+ or \verb+xelatex+, included figures need to be in
\verb+pdf+, \verb+jpg+, or \verb+png+ format. If you want to include eps
figures, you can easily convert them to \verb+pdf+ using the command
\begin{verbatim}
ps2pdf -dEPSCrop figure.eps figure.pdf
\end{verbatim}

\begin{thebibliography}{69}
\bibitem{lamport94} Leslie Lamport, \emph{\LaTeX: A Document Preparation
System}. Addison Wesley, Massachusetts, 2nd Edition, 1994.
\end{thebibliography}

\newpage

\appendix

\section{Source Code}

Include all source code here in the appendix. Keep the code formatting clean,
use indentation, and comment your code to make it easy to understand. Also,
break lines that are too long. (Keep them under 80 characters!)

\subsection{Calculating pi using matlab: \texttt{pi.m}}
\lstinputlisting[language=matlab,numbers=left]{template_files/pi.m}

\subsection{Calculating pi using python: \texttt{pi.py}}
\lstinputlisting[language=python,numbers=left]{template_files/pi.py}

\subsection{Calculating pi using C: \texttt{pi.c}}
\lstinputlisting[language=c,numbers=left]{template_files/pi.c}

\end{comment}

\end{document}
